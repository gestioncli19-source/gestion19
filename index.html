<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Gestor de Clientes</title>
  
  <!-- Enlace a tu hoja de estilos CSS -->
  <link rel="stylesheet" href="style.css"> 
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <!-- Enlace a Font Awesome para el icono de Engranaje (Settings) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>

<body>

<section id="section-login" class="show">
  <div class="login-box">
    <h2>Gestor de Clientes</h2>
    <form id="form-login">
      <label for="login-email">Email</label>
      <input type="email" id="login-email" required />

      <label for="login-password" style="margin-top: 10px;">Contraseña</label>
      <input type="password" id="login-password" required />

      <div id="login-error-message"></div>

      <button type="submit" class="btn edit" style="width: 100%; margin-top: 15px;">Iniciar Sesión</button>
    </form>
  </div>
</section>

<div class="container" id="app-container" style="display:none;">

<header>
  <div class="brand">
    <div class="logo">GC</div>
    <div><div style="font-weight:700">Gestor Clientes</div></div>
  </div>
  <nav>
    <div class="menu">
      <button id="nav-dashboard" class="active">Dashboard</button>
      <button id="nav-clientes">Clientes</button>
      <button id="nav-add">Añadir cliente</button>
      <!-- Nuevo botón de AJUSTES (Engranaje) -->
      <button id="nav-settings" title="Ajustes y Opciones">
        <i class="fas fa-cog"></i>
      </button> 
    </div>
  </nav>
</header>

<main>

<section id="section-dashboard">
  <div class="cards-col">
    <div class="stat">
      <h3>Total clientes</h3><p id="stat-total">—</p>
    </div>
    <div class="stat stat-clickable" id="stat-3days-link" title="Haz clic para filtrar clientes.">
      <h3>Caducan en 3 días</h3><p id="stat-today-3days">—</p>
    </div>
    <div class="stat stat-clickable" id="stat-expired-link" title="Haz clic para filtrar clientes.">
      <h3>Cliente caducado</h3><p id="stat-expired">—</p>
    </div>
  </div>
  <div id="dashboard-soon-exp" class="cards" style="margin-top: 18px">
    <p class="meta" style="grid-column: 1 / -1; margin-bottom: 0;">Clientes que caducan en los próximos 3 días:</p>
  </div>
</section>

<section id="section-clientes" style="display:none">
  <div class="card-form">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
      <h3>Clientes</h3>
      <!-- Botón Exportar CSV eliminado de aquí, movido a Ajustes -->
    </div>
    
    <input type="text" id="search-input" placeholder="Buscar por Nombre, Usuario o Aplicación..." style="margin-bottom: 12px;" />

    <div id="clients-grid" class="grid-clients" style="margin-top:10px"></div>
  </div>
</section>

<section id="section-add" style="display:none">
  <div class="card-form">
    <h3>Añadir cliente</h3>
    <form id="form-add">

      <label>Nombre</label>
      <input type="text" id="f-nombre" required />
      
      <label>Teléfono (Ej: 34600123456)</label>
      <input type="text" id="f-telefono" value="+34" placeholder="Código de país + número (sin espacios)" />

      <div class="row">
        <div>
          <label>Fecha de creación</label>
          <input type="date" id="f-creacion" required />
        </div>
        <div>
          <label>Caducidad</label>
          <input type="date" id="f-caducidad" required />
        </div>
      </div>

      <label>Usuario</label>
      <input type="text" id="f-usuario" />

      <label>Contraseña</label>
      <input type="text" id="f-contrasena" />

      <label>Dispositivo utilizado</label>
      <input type="text" id="f-dispositivo" />

      <label>Aplicación</label>
      <select id="f-aplicacion">
        <option value="Spinning TV">Spinning TV</option>
        <option value="Spinning IBO">Spinning IBO</option>
        <option value="Spinning Mate">Spinning Mate</option>
        <option value="Hot Player">Hot Player</option>
      </select>

      <label>Clientes recomendados</label>
      <div id="f-recomendaciones-container" class="dynamic-input-container">
          <div id="f-recommended-clients" class="tag-list"></div>
          <div class="input-add-row">
              <input type="text" id="f-new-recommendation" placeholder="Nombre de cliente recomendado" />
              <button type="button" class="btn copy" id="f-add-recommendation-btn">+</button>
              </div>
      </div>

      <div style="display:flex;gap:8px;margin-top:8px">
        <button type="submit" class="btn edit">Guardar</button>
        <button type="button" id="f-reset" class="btn copy">Reset</button>
      </div>

    </form>
  </div>
</section>

<section id="section-tutorial" style="display:none">
    <div class="card-form">
        <h3>Guía de Uso del Gestor de Clientes</h3>
        <div style="font-size: 14px; color: var(--muted); line-height: 1.6;">
            <p style="color: var(--accent); font-weight: 600;">Bienvenido al tutorial. A continuación, se detalla la función de cada sección y botón de la aplicación.</p>

            <h4>1. Dashboard (Panel Principal)</h4>
            <ul>
                <li><strong>Métricas:</strong> Muestra el resumen de la aplicación.</li>
                <li><strong>Clientes Próximos a Caducar:</strong> Se muestra en **fila horizontal** con un estilo único.</li>
            </ul>

            <h4>2. Clientes (Listado)</h4>
            <p>Muestra todas las tarjetas de clientes. Se aplican **colores variados** en el borde izquierdo para una distinción visual.</p>
            <ul>
                <li><strong>Botón Copiar:</strong> Copia `Usuario`, `Contraseña`, `Aplicación` y `Fecha de caducidad`.</li>
                <li><strong>Botón Mes Gratis:</strong> Solo se activa si el cliente tiene **3 o más recomendaciones registradas**.</li>
            </ul>

            <h4>3. Modal de Edición</h4>
            <p>La ventana de edición está optimizada (Scrollable y responsive) para funcionar correctamente en **móvil y PC**.</p>
            <ul>
                <li>**Teléfono:** El campo ya viene con el prefijo `+34` por defecto.</li>
            </ul>
        </div>
    </div>
</section>

<!-- NUEVA SECCIÓN: AJUSTES -->
<section id="section-settings" style="display:none">
    <div class="card-form">
        <h3>Ajustes y Opciones Avanzadas</h3>
        <div class="settings-grid">
            
            <div class="setting-option" onclick="handleImportClick()">
                <h4><i class="fas fa-file-import"></i> Importar Clientes (CSV)</h4>
                <p>Cargar nuevos clientes o actualizar datos masivamente desde un archivo CSV.</p>
                <input type="file" id="file-import-csv" accept=".csv" style="display: none;">
            </div>

            <div class="setting-option" id="btn-export-csv">
                <h4><i class="fas fa-file-export"></i> Exportar Clientes (CSV)</h4>
                <p>Descargar una copia de seguridad de todos tus clientes en formato CSV.</p>
            </div>

            <div class="setting-option" onclick="switchSection('tutorial')">
                <h4><i class="fas fa-book"></i> Tutorial de Uso</h4>
                <p>Ver la guía detallada de todas las funciones de la aplicación.</p>
            </div>

            <div class="setting-option logout" id="btn-logout-settings">
                <h4><i class="fas fa-sign-out-alt"></i> Cerrar Sesión</h4>
                <p>Finalizar la sesión actual.</p>
            </div>
        </div>
    </div>
</section>

</main>

<footer></footer>

</div>

<div id="modal" class="modal">
  <div class="modal-inner">
    <h3 id="modal-title">Editar cliente</h3>
    <form id="form-edit">

      <label>Nombre</label>
      <input type="text" id="e-nombre" required /> 
      
      <label>Teléfono (Ej: 34600123456)</label>
      <input type="text" id="e-telefono" placeholder="Código de país + número (sin espacios)" /> 

      <div class="row">
        <div>
          <label>Fecha de creación</label>
          <input type="date" id="e-creacion" required /> 
        </div>
        <div>
          <label>Caducidad</label>
          <input type="date" id="e-caducidad" required /> 
        </div>
      </div>

      <label>Usuario</label>
      <input type="text" id="e-usuario" /> 

      <label>Contraseña</label>
      <input type="text" id="e-contrasena" /> 

      <label>Dispositivo utilizado</label>
      <input type="text" id="e-dispositivo" /> 

      <label>Aplicación</label>
      <select id="e-aplicacion"> 
        <option value="Spinning TV">Spinning TV</option>
        <option value="Spinning IBO">Spinning IBO</option>
        <option value="Spinning Mate">Spinning Mate</option>
        <option value="Hot Player">Hot Player</option>
      </select>

      <label>Clientes recomendados</label>
      <div id="e-recomendaciones-container" class="dynamic-input-container">
          <div id="e-recommended-clients" class="tag-list"></div>
          <div class="input-add-row">
              <input type="text" id="e-new-recommendation" placeholder="Nombre de cliente recomendado" />
              <button type="button" class="btn copy" id="e-add-recommendation-btn">+</button>
               </div>
      </div>

      <div style="display:flex;gap:8px;margin-top:8px;justify-content:space-between">
        <button type="button" id="btn-history-open" class="btn history">Ver Historial</button>
        <div style="display:flex;gap:8px;">
          <button type="button" id="modal-cancel" class="btn copy">Cancelar</button>
          <button type="submit" class="btn edit">Guardar cambios</button>
        </div>
      </div>
    </form>
  </div>
</div>

<div id="history-modal" class="modal">
  <div class="modal-inner history">
    <h3 id="history-modal-title">Historial de Renovaciones</h3>
    <div id="history-list" style="max-height: 400px; overflow-y: auto;">
        </div>
    <div style="text-align: right; margin-top: 15px;">
        <button type="button" id="history-modal-close" class="btn copy">Cerrar</button>
    </div>
  </div>
</div>

<div id="notifications-container"></div>


<!-- Enlace a tu lógica JavaScript -->
<script type="module" src="script.js"></script>

</body>
</html>

